{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user's profile information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The user's unique ID, matching their Firebase Auth UID."
        },
        "name": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "The timestamp when the user profile was created."
        }
      },
      "required": ["id", "email", "createdAt"]
    },
    "NetworkProvider": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "NetworkProvider",
      "type": "object",
      "description": "Represents a mobile network provider in Nigeria (e.g., MTN, Airtel, Glo, 9mobile).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the network provider."
        },
        "name": {
          "type": "string",
          "description": "Name of the network provider (e.g., MTN)."
        },
        "iconUrl": {
          "type": "string",
          "description": "URL to the network provider's icon.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "DataPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DataPlan",
      "type": "object",
      "description": "Represents a specific data plan offered by a network provider.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the data plan."
        },
        "networkProviderId": {
          "type": "string",
          "description": "Reference to NetworkProvider. (Relationship: NetworkProvider 1:N DataPlan)"
        },
        "dataAmount": {
          "type": "string",
          "description": "The amount of data offered in the plan (e.g., '1GB', '2GB')."
        },
        "price": {
          "type": "number",
          "description": "The price of the data plan in Nigerian Naira (NGN)."
        },
        "validityDays": {
          "type": "number",
          "description": "The number of days the data plan is valid for."
        },
        "description": {
          "type": "string",
          "description": "Description of data plan"
        }
      },
      "required": [
        "id",
        "networkProviderId",
        "dataAmount",
        "price"
      ]
    },
    "CustomerOrder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CustomerOrder",
      "type": "object",
      "description": "Represents a customer's order for a data plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the customer order."
        },
        "dataPlanId": {
          "type": "string",
          "description": "Reference to DataPlan. (Relationship: DataPlan 1:N CustomerOrder)"
        },
        "customerName": {
          "type": "string",
          "description": "Name of the customer who placed the order."
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the customer."
        },
        "email": {
          "type": "string",
          "description": "Email address of the customer (optional).",
          "format": "email"
        },
        "referralCode": {
          "type": "string",
          "description": "Referral code used by the customer (optional)."
        },
        "orderDate": {
          "type": "string",
          "description": "Date and time when the order was placed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "dataPlanId",
        "customerName",
        "phoneNumber"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information, keyed by the user's UID."
        }
      },
      {
        "path": "/networkProviders/{networkProviderId}",
        "definition": {
          "entityName": "NetworkProvider",
          "schema": {
            "$ref": "#/backend/entities/NetworkProvider"
          },
          "description": "Stores details about mobile network providers. Includes provider ID as the document ID.",
          "params": [
            {
              "name": "networkProviderId",
              "description": "The unique ID of the network provider."
            }
          ]
        }
      },
      {
        "path": "/dataPlans/{dataPlanId}",
        "definition": {
          "entityName": "DataPlan",
          "schema": {
            "$ref": "#/backend/entities/DataPlan"
          },
          "description": "Stores details about data plans offered by network providers.  `networkProviderId` field is used to reference the relevant network provider.",
          "params": [
            {
              "name": "dataPlanId",
              "description": "The unique ID of the data plan."
            }
          ]
        }
      },
      {
        "path": "/customerOrders/{customerOrderId}",
        "definition": {
          "entityName": "CustomerOrder",
          "schema": {
            "$ref": "#/backend/entities/CustomerOrder"
          },
          "description": "Stores customer order information.  No denormalized fields required as there is no collaborative aspect to the application.",
          "params": [
            {
              "name": "customerOrderId",
              "description": "The unique ID of the customer order."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage network providers, data plans, and customer orders for a mobile data plan sales application.  Authorization Independence is achieved by eliminating the need for `get()` calls in security rules.  Since the application does not involve user accounts or collaborative data, explicit authorization mechanisms like ownership or membership maps are not required. The structure is segregated by entity type, allowing for simple rules. Specifically, the data plans are linked to network providers via the `networkProviderId` field, but each data plan document is independent and doesn't require reading the parent network provider document for authorization.\n\nThis structure supports the required QAPs by:\n\n*   **Network Providers**: The `/networkProviders` collection allows listing all providers, and security rules can ensure that only authorized users (e.g., admins, if any) can create/update/delete them.\n*   **Data Plans**: The `/dataPlans` collection allows listing data plans, and security rules can restrict creation/updates/deletions as needed.  Since there is no user-specific data, filtering is not a security concern here.\n*   **Customer Orders**: The `/customerOrders` collection stores order data, but since the processing is handled via WhatsApp, and no user accounts are present, the focus is on data integrity and preventing unauthorized creation of order documents (if any server side logic were added later)."
  }
}
